<!-- AvatarSalesPro Integration Snippet -->
<div id="avatar-sales-pro-widget"></div>

<script>
// Konfiguration
const avatarConfig = {
    serverUrl: "https://avatarsales-pro-bot.onrender.com",
    position: "bottom-right",
    primaryColor: "#2F80ED",
    avatarName: "Sales Assistant",
    welcomeMessage: "Hallo! Ich bin Ihr digitaler Verkaufsassistent. Wie kann ich Ihnen helfen?"
};

// Widget Initialisierung
function initAvatarWidget() {
    const widgetContainer = document.getElementById('avatar-sales-pro-widget');
    
    // Avatar UI erstellen
    widgetContainer.innerHTML = `
        <div style="position: fixed; ${avatarConfig.position === 'bottom-right' ? 'bottom: 20px; right: 20px;' : 'bottom: 20px; left: 20px;'} z-index: 10000;">
            <div id="avatar-chat-container" style="display: none; width: 350px; background: white; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.15);">
                <div style="background: ${avatarConfig.primaryColor}; color: white; padding: 15px; border-radius: 15px 15px 0 0;">
                    <strong>${avatarConfig.avatarName}</strong>
                    <button onclick="toggleChat()" style="float: right; background: none; border: none; color: white; cursor: pointer;">âœ•</button>
                </div>
                <div id="chat-messages" style="height: 300px; overflow-y: auto; padding: 15px;"></div>
                <div style="padding: 15px; border-top: 1px solid #eee;">
                    <input type="text" id="user-input" placeholder="Stellen Sie eine Frage..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    <button onclick="sendMessage()" style="width: 100%; margin-top: 10px; padding: 10px; background: ${avatarConfig.primaryColor}; color: white; border: none; border-radius: 5px; cursor: pointer;">Senden</button>
                </div>
            </div>
            <button onclick="toggleChat()" style="background: ${avatarConfig.primaryColor}; color: white; border: none; border-radius: 50%; width: 60px; height: 60px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                ðŸ¤–
            </button>
        </div>
    `;
    
    // BegrÃ¼ÃŸungsnachricht anzeigen
    setTimeout(() => {
        addMessage(avatarConfig.welcomeMessage, 'bot');
    }, 1000);
}

// Chat-Funktionen
function toggleChat() {
    const chatContainer = document.getElementById('avatar-chat-container');
    chatContainer.style.display = chatContainer.style.display === 'none' ? 'block' : 'none';
}

function addMessage(text, sender) {
    const messagesContainer = document.getElementById('chat-messages');
    const messageDiv = document.createElement('div');
    messageDiv.style.marginBottom = '10px';
    messageDiv.style.padding = '8px 12px';
    messageDiv.style.borderRadius = '10px';
    messageDiv.style.background = sender === 'user' ? '#e3f2fd' : '#f5f5f5';
    messageDiv.style.marginLeft = sender === 'user' ? '40px' : '0';
    messageDiv.style.marginRight = sender === 'user' ? '0' : '40px';
    messageDiv.textContent = text;
    messagesContainer.appendChild(messageDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

async function sendMessage() {
    const input = document.getElementById('user-input');
    const message = input.value.trim();
    
    if (!message) return;
    
    addMessage(message, 'user');
    input.value = '';
    
    try {
        const response = await fetch(`${avatarConfig.serverUrl}/chat`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ message: message })
        });
        
        const data = await response.json();
        addMessage(data.text, 'bot');
        
        // Hier kommt spÃ¤ter die Audio-Wiedergabe und MascotBot-Integration
        console.log('Audio generated:', data.audio_generated);
        
    } catch (error) {
        addMessage('Entschuldigung, ein Fehler ist aufgetreten.', 'bot');
        console.error('Error:', error);
    }
}

// Widget initialisieren wenn Seite geladen
document.addEventListener('DOMContentLoaded', initAvatarWidget);
</script>